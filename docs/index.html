<!DOCTYPE html>
<html lang="en" dir="auto">

<head>
	<meta name="generator" content="Hugo 0.135.0"><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Curiouser and Curiouser!</title>

<meta name="description" content="">
<meta name="author" content="">
<link rel="canonical" href="https://cyber-eg0.github.io/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.fc220c15db4aef0318bbf30adc45d33d4d7c88deff3238b23eb255afdc472ca6.css" integrity="sha256-/CIMFdtK7wMYu/MK3EXTPU18iN7/MjiyPrJVr9xHLKY=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://cyber-eg0.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://cyber-eg0.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://cyber-eg0.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://cyber-eg0.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://cyber-eg0.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" type="application/rss+xml" href="https://cyber-eg0.github.io/index.xml">
<link rel="alternate" hreflang="en" href="https://cyber-eg0.github.io/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="Curiouser and Curiouser!" />
<meta property="og:description" content="" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://cyber-eg0.github.io/" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Curiouser and Curiouser!"/>
<meta name="twitter:description" content=""/>

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Organization",
  "name": "Curiouser and Curiouser!",
  "url": "https://cyber-eg0.github.io/",
  "description": "",
  "thumbnailUrl": "https://cyber-eg0.github.io/favicon.ico",
  "sameAs": [
      
  ]
}
</script>
</head>

<body class="list" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://cyber-eg0.github.io/" accesskey="h" title="Curiouser and Curiouser! (Alt + H)">Curiouser and Curiouser!</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://cyber-eg0.github.io/categories/" title="categories">
                    <span>categories</span>
                </a>
            </li>
            <li>
                <a href="https://cyber-eg0.github.io/tags/" title="tags">
                    <span>tags</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main"> 

<article class="first-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">ESXHiDE - ESXi Rootkit Development - Part 3
      <span class="entry-hint" title="Draft">
        <svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" fill="currentColor">
          <path
            d="M160-410v-60h300v60H160Zm0-165v-60h470v60H160Zm0-165v-60h470v60H160Zm360 580v-123l221-220q9-9 20-13t22-4q12 0 23 4.5t20 13.5l37 37q9 9 13 20t4 22q0 11-4.5 22.5T862.09-380L643-160H520Zm300-263-37-37 37 37ZM580-220h38l121-122-18-19-19-18-122 121v38Zm141-141-19-18 37 37-18-19Z" />
        </svg>
      </span>
    </h2>
  </header>
  <div class="entry-content">
    <p>Looping Through Syscall Table Once I was able to grab the base address of the user module, I was able to use an offset to find Linux64_SyscallTable and Linux64_SyscallTableLen variables and loop through them to print out the syscalls for some sanity check.
uint64_t Linux64_SyscallTableLen = *(uint64_t*)(user_mod_addr &#43; 0x935C0); SyscallTable_Entry* Linux64_SyscallTable = (SyscallTable_Entry*)(user_mod_addr &#43; 0x935E0); for (i = 0; i &lt; Linux64_SyscallTableLen; i&#43;&#43;) { printk(&#34;SYSCALL TABLE ENTRY %d: %s -&gt; %p\n&#34;, i, Linux64_SyscallTable[i].name, Linux64_SyscallTable[i].func); } ...</p>
  </div>
  <footer class="entry-footer"><span title='2024-09-30 23:47:39 -0500 CDT'>September 30, 2024</span></footer>
  <a class="entry-link" aria-label="post link to ESXHiDE - ESXi Rootkit Development - Part 3" href="https://cyber-eg0.github.io/posts/esxi-rootkit-3/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">ESXHiDE - ESXi Rootkit Development - Part 2
      <span class="entry-hint" title="Draft">
        <svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" fill="currentColor">
          <path
            d="M160-410v-60h300v60H160Zm0-165v-60h470v60H160Zm0-165v-60h470v60H160Zm360 580v-123l221-220q9-9 20-13t22-4q12 0 23 4.5t20 13.5l37 37q9 9 13 20t4 22q0 11-4.5 22.5T862.09-380L643-160H520Zm300-263-37-37 37 37ZM580-220h38l121-122-18-19-19-18-122 121v38Zm141-141-19-18 37 37-18-19Z" />
        </svg>
      </span>
    </h2>
  </header>
  <div class="entry-content">
    <p>Extracting VMkernel &amp; Modules In a post on ZDI, renorobertr shows how to locate and extract the VMkernel (and other modules like user).
VMkernel can be found by extracting /bootbank/k.b00 and user* module can be extracted from /bootbank/user.b00.
*More on what’s in user module later
He also demonstrates using a native binary (esxcfg-info -y) to get a module’s key memory addresses, which came in handy for reversing the module list and module structures.
...</p>
  </div>
  <footer class="entry-footer"><span title='2024-09-29 13:16:49 -0500 CDT'>September 29, 2024</span></footer>
  <a class="entry-link" aria-label="post link to ESXHiDE - ESXi Rootkit Development - Part 2" href="https://cyber-eg0.github.io/posts/esxi-rootkit-2/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">ESXHiDE - ESXi Rootkit Development - Part 1
      <span class="entry-hint" title="Draft">
        <svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" fill="currentColor">
          <path
            d="M160-410v-60h300v60H160Zm0-165v-60h470v60H160Zm0-165v-60h470v60H160Zm360 580v-123l221-220q9-9 20-13t22-4q12 0 23 4.5t20 13.5l37 37q9 9 13 20t4 22q0 11-4.5 22.5T862.09-380L643-160H520Zm300-263-37-37 37 37ZM580-220h38l121-122-18-19-19-18-122 121v38Zm141-141-19-18 37 37-18-19Z" />
        </svg>
      </span>
    </h2>
  </header>
  <div class="entry-content">
    <p>Introduction For some time now, I’ve been told that ESXi VMkernel is NOT Linux. After some research into developing user mode (or user world, as VMware calls it) tools, I finally understood what that meant. I won’t be going into all of the differences in this series but for those who are curious, this whitepaper on ESXi architecture is a good starting point. My mind started to drift away from user mode tools to kernel mode security tools. The only real resources I was able to find online were those related to things like USB and NIC drivers. VMkernel is able to run some Linux kernel modules, but not all. This series will go into my research and methods on creating a proof-of-concept rootkit called ESXHiDE on ESXi VMkernel to intercept system calls.
...</p>
  </div>
  <footer class="entry-footer"><span title='2024-09-29 10:19:57 -0500 CDT'>September 29, 2024</span></footer>
  <a class="entry-link" aria-label="post link to ESXHiDE - ESXi Rootkit Development - Part 1" href="https://cyber-eg0.github.io/posts/esxi-rootkit-1/"></a>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2024 <a href="https://cyber-eg0.github.io/">Curiouser and Curiouser!</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
